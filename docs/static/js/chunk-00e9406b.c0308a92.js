(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-00e9406b"],{2547:function(e,r,t){},"2a60":function(e,r,t){"use strict";t("2547")},"6d5b":function(e,r,t){"use strict";t.r(r);var o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{ref:"widgetBox",staticClass:"sketch-comp-inner widget-container img-chunk",class:{"is-loaded":e.base64},staticStyle:{width:"100%",height:"100%"},style:{"background-color":e.config.style.fills["enabled"]?e.config.style.fills["color"]:"transparent","border-style":e.config.style.border["enabled"]?e.config.style.border["style"]:"none","border-color":e.config.style.border["color"],"border-width":e.config.style.border["width"]+"px","border-radius":e.config.style.border["radius"].reduce((function(e,r){return e+(r+"px ")}),""),visibility:e.config.edit.visible?"visible":"hidden",opacity:e.config.edit.opacity},on:{dblclick:function(r){return r.stopPropagation(),e.clip.apply(null,arguments)}}},["clip"==e.mode?t("div",{staticClass:"handler",on:{click:e.closeEditing}},[t("i",{staticClass:"mdi mdi-clear"})]):e._e(),t("div",{staticClass:"image-wrapper"},["editor"==e.mode?[t("img",{style:{width:e.config.crop&&e.config.crop.width?e.config.frame.width/e.config.crop.width+"px":"100%",height:e.config.crop&&e.config.crop.height?e.config.frame.height/e.config.crop.height+"px":"100%",transform:e.config.crop&&e.config.crop.height?" translate( -"+e.config.frame.width/e.config.crop.width*e.config.crop.x+"px, -"+e.config.frame.height/e.config.crop.height*e.config.crop.y+"px)":""},attrs:{alt:"01",src:e.base64}})]:t("div",{style:{width:"100%",height:"100%"}},[t("vueCropper",{ref:"cropper",attrs:{"can-scale":!1,img:e.base64,"output-size":e.size,info:!0,"can-move":!1,"can-move-box":!0,"fixed-box":!1,original:!1,"info-true":!0,"edit-scale":e.editScale,mode:"100% 100%"},on:{imgLoad:e.imgLoad,cropMoving:e.cropMoving}})],1)],2)])},c=[],i=t("b85c"),n=t("1da1"),a=(t("96cf"),t("d3b7"),t("27d4")),s=function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r){var t,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(r);case 2:if(t=e.sent,200===t.status){e.next=5;break}return e.abrupt("return","");case 5:return e.next=7,t.blob();case 7:return o=e.sent,e.abrupt("return",new Promise((function(e){var r=new FileReader;r.readAsDataURL(o),r.onloadend=function(){var t=r.result;e(t)}})));case 9:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),p={name:"ItemImage",props:{config:{type:Object,default:function(){return a["a"]["basic"]["image"]}},dataSource:{type:Array,default:function(){return[{label:"label",value:!1,type:"boolean"}]}}},data:function(){return{mode:"editor",base64:"",size:1,cropData:null}},computed:{editScale:function(){return this.$store.state.editor.user.editScale}},watch:{"config.crop":{handler:function(e,r){console.log("config.crop"),console.log(this.config.frame.width)},deep:!0}},created:function(){this.$bus.on("CANCEL_CROPPING",this.closeEditing)},beforeDestroy:function(){this.$bus.off("CANCEL_CROPPING",this.closeEditing)},mounted:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.init();case 2:case"end":return r.stop()}}),r)})))()},methods:{cropMoving:function(e){this.cropData=e.axis,console.log(this.cropData)},imgLoad:function(e){console.log("imgLoad",e)},init:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var t,o,c,n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t=["","https://api.allorigins.win/raw?url=","https://cors.eu.org/","https://scrappy-php.herokuapp.com/?url="],!e.config.style.img.url){r.next=31;break}o=Object(i["a"])(t),r.prev=3,o.s();case 5:if((c=o.n()).done){r.next=21;break}return n=c.value,r.prev=7,r.next=10,s(n+e.config.style.img.url);case 10:a=r.sent,e.base64=a,r.next=17;break;case 14:r.prev=14,r.t0=r["catch"](7),console.log(n+e.config.style.img.url+" "+r.t0);case 17:if(""===e.base64){r.next=19;break}return r.abrupt("break",21);case 19:r.next=5;break;case 21:r.next=26;break;case 23:r.prev=23,r.t1=r["catch"](3),o.e(r.t1);case 26:return r.prev=26,o.f(),r.finish(26);case 29:r.next=32;break;case 31:e.base64=e.config.style.img.base64;case 32:case"end":return r.stop()}}),r,null,[[3,23,26,29],[7,14]])})))()},editableChange:function(){this.$nextTick((function(){}))},clip:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return console.log("clip"),e.$emit("edit"),e.mode="clip",r.next=5,e.$store.dispatch("canvas/editCrop",{id:e.config.$id});case 5:e.cropData=r.sent,console.log(e.cropData),e.$nextTick((function(){console.log("this.$refs.cropper",e.$refs.cropper),e.$refs.cropper&&(e.$refs.cropper.startCrop(),e.cropData?(console.log(" this.$refs.cropper.goAutoCrop()"),e.$nextTick((function(){console.log(" this.$nextTick"),e.$refs.cropper.cropOffsertX=e.cropData.x1,e.$refs.cropper.cropOffsertY=e.cropData.y1,e.$refs.cropper.cropW=e.cropData.x2-e.cropData.x1,e.$refs.cropper.cropH=e.cropData.y2-e.cropData.y1,e.$refs.cropper.cropping=!0,console.log(e.$refs.cropper)}))):e.$refs.cropper.startCrop())}));case 8:case"end":return r.stop()}}),r)})))()},closeEditing:function(){this.$refs.cropper&&(this.cropData||(this.cropData={x1:this.$refs.cropper.cropOffsertX,x2:this.$refs.cropper.cropW+this.$refs.cropper.cropOffsertX,y1:this.$refs.cropper.cropOffsertY,y2:this.$refs.cropper.cropH+this.$refs.cropper.cropOffsertY}),console.log(this.config),console.log(this.cropData),this.$store.dispatch("canvas/crop",{id:this.config.$id,x1:this.cropData.x1,x2:this.cropData.x2,y1:this.cropData.y1,y2:this.cropData.y2}),this.$refs.cropper&&this.$refs.cropper.stopCrop(),this.cropData=null,this.$emit("cancel"),this.mode="editor")}}},f=p,l=(t("2a60"),t("2877")),u=Object(l["a"])(f,o,c,!1,null,"6f59dc33",null);r["default"]=u.exports}}]);